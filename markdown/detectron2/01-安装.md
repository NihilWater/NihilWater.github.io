# detectron2 安装

## 要求
- Linux 或 macOS 与 Python ≥ 3.6, 作者亲测 windows10 上运行正常。
- PyTorch ≥ 1.8 和与PyTorch安装相匹配的 torchvision。在pytorch.org 上将它们一起安装以确保这一点
- OpenCV 是可选的，但演示和可视化需要
- 确保安装 gcc & g++ ≥ 5.4


## 安装指令
```shell
git clone https://github.com/facebookresearch/detectron2.git
python -m pip install -e detectron2

# 在 macOS, you 你需要在运行命令前加入以下环境变量
CC=clang CXX=clang++ ARCHFLAGS="-arch x86_64" python -m pip install ...
```


## 错误汇总
> error: command 'C:\\Program Files\\NVIDIA GPU Computing Toolkit\\CUDA\\v11.3\\bin\\nvcc.exe' failed
【解决方案】

在git 克隆的文件夹里找到 detectron2\layers\csrc\nms_rotated\nms_rotated_cuda.cudetectron2\layers\csrc\nms_rotated\nms_rotated_cuda.cu 文件。

里面原始的内容开头是这个样的

```c
// Copyright (c) Facebook, Inc. and its affiliates.
#include <ATen/ATen.h>
#include <ATen/cuda/CUDAContext.h>
#include <c10/cuda/CUDAGuard.h>
#include <ATen/cuda/CUDAApplyUtils.cuh>
#ifdef WITH_CUDA
#include "../box_iou_rotated/box_iou_rotated_utils.h"
#endif
// TODO avoid this when pytorch supports "same directory" hipification
#ifdef WITH_HIP
#include "box_iou_rotated/box_iou_rotated_utils.h"
#endif
```
将以上的内容修改为
```c
// Copyright (c) Facebook, Inc. and its affiliates.
#include <ATen/ATen.h>
#include <ATen/cuda/CUDAContext.h>
#include <c10/cuda/CUDAGuard.h>
#include <ATen/cuda/CUDAApplyUtils.cuh>
/*#ifdef WITH_CUDA
#include "../box_iou_rotated/box_iou_rotated_utils.h"
#endif
// TODO avoid this when pytorch supports "same directory" hipification
#ifdef WITH_HIP
#include "box_iou_rotated/box_iou_rotated_utils.h"
#endif*/
#include "box_iou_rotated/box_iou_rotated_utils.h"
```

## 
参考： [https://blog.csdn.net/m0_56192771/article/details/123194532](https://blog.csdn.net/m0_56192771/article/details/123194532)
