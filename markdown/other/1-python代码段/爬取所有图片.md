# python 爬取一个网页下所有图片

```python
import requests
import re
import time

from urllib.parse import urlparse, parse_qs, parse_qsl


def get_html(url):
    '''
    两个参数
    :param url:统一资源定位符,请求网址
    :param headers:请求头
    :return:html
    '''

    response = requests.get(url)
    # 获取网页信息文本
    html = response.text
    # ***************** End ******************** #
    return html


def findImageUrl(html):
    '''
    通过正则表达式匹配html 文本里的所有图片
    :param html:
    :return:
    '''
    pattern = re.compile(r'<img .*?src="(.*?)"')
    return pattern.findall(html)


def getImageByLink(url):
    resp = requests.get(url)  # 获取网页信息
    byte = resp.content  # 转化为content二进制
    return byte


if __name__ == '__main__':
    base_url = "http://*****"
    out_path = "imgs/"

    scheme = urlparse(base_url).scheme
    hostname = urlparse(base_url).hostname

    # 1. 获取指定url 下的所有图片
    html = get_html(base_url)
    print(html)

    # 2. 使用正则表达式获取所有的图片链接
    imgurls = findImageUrl(html)
    print(imgurls)

    # 3. 通过图片连接下载
    i = 0
    for img_url in imgurls:
        img_url = scheme + "://" + hostname + img_url if img_url[0] == '/' else base_url + '/' + img_url
        with open("imgs/{}.jpg".format(i), "wb") as f:  # 文件写入
            byte = getImageByLink(img_url)
            f.write(byte)
            time.sleep(0.1)
        print("第{}张图片爬取成功!".format(i))
        i = i + 1

```